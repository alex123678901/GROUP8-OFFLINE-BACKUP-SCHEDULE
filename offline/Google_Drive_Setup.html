<!DOCTYPE html>
<html>
<head>
    <title>Google Drive Setup Instructions</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        .step { background: #f4f4f4; padding: 15px; margin: 10px 0; border-left: 4px solid #4285f4; }
        code { background: #eee; padding: 2px 6px; border-radius: 3px; }
        .important { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; }
    </style>
</head>
<body>
    <h1>üìÅ Google Drive Auto-Upload Setup</h1>
    
    <div class="important">
        <h3>üîß Setup Required for Cloud Backup</h3>
        <p>Follow these steps to enable automatic Google Drive uploads:</p>
    </div>
    
    <div class="step">
        <h3>Step 1: Create Google Apps Script</h3>
        <ol>
            <li>Go to <a href="https://script.google.com/" target="_blank">script.google.com</a></li>
            <li>Click "New Project"</li>
            <li>Replace the code with the provided script</li>
        </ol>
    </div>
    
    <div class="step">
        <h3>Step 2: Copy This Script Code</h3>
        <textarea id="scriptCode" rows="20" cols="80" style="width: 100%; font-family: monospace;">
function doPost(e) {
  try {
    var folderId = '1VwYFb0Kna3xRVEUecw4tjQAJFuGeuR4Q';
    var folder = DriveApp.getFolderById(folderId);
    
    var department = e.parameter.department || 'UnknownDepartment';
    var blob = e.parameter.file;
    
    if (blob) {
      var fileName = department + '_Backup_' + new Date().toISOString().replace(/[:.]/g, '-') + '.zip';
      var file = folder.createFile(blob);
      file.setName(fileName);
      
      return ContentService.createTextOutput(JSON.stringify({
        status: 'success',
        fileId: file.getId(),
        fileName: fileName,
        department: department
      })).setMimeType(ContentService.MimeType.JSON);
    } else {
      var logFile = folder.createFile(
        department + '_Backup_Log_' + new Date().toISOString().replace(/[:.]/g, '-') + '.txt',
        'Backup completed for ' + department + ' at ' + new Date().toISOString(),
        'text/plain'
      );
      
      return ContentService.createTextOutput(JSON.stringify({
        status: 'success',
        fileId: logFile.getId(),
        fileName: logFile.getName(),
        department: department
      })).setMimeType(ContentService.MimeType.JSON);
    }
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      status: 'error',
      error: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  return ContentService.createTextOutput('Google Drive Backup Service is Running');
}
        </textarea>
        <button onclick="copyScript()">Copy Script Code</button>
    </div>
    
    <div class="step">
        <h3>Step 3: Deploy as Web App</h3>
        <ol>
            <li>Click "Deploy" ‚Üí "New deployment"</li>
            <li>Select "Web app" as type</li>
            <li>Set "Execute as" to "Me"</li>
            <li>Set "Who has access" to "Anyone"</li>
            <li>Copy the Web App URL and update the application</li>
        </ol>
    </div>
    
    <div class="step">
        <h3>Step 4: Update Application URL</h3>
        <p>Replace the <code>UPLOAD_SCRIPT_URL</code> in MainDashboard.java with your Web App URL</p>
    </div>
    
    <script>
    function copyScript() {
        var textarea = document.getElementById('scriptCode');
        textarea.select();
        document.execCommand('copy');
        alert('Script code copied to clipboard!');
    }
    </script>
</body>
</html>